global:
  - namespace=Flatrock
  - binary_offset
  - emit_binary
  - emit_fieldname
  - emit_json
  - enable_disable
  - input_binary
  - widereg
  # - write_dma=galois_field_matrix
generate:
  memories:
    tfc_mem:
      args: [ name=memories.top ]
      memories.ftr_mem.h: [ decl ]
      memories.ftr_mem.cpp: [ defn, -Imemories.ftr_mem.h, -Imemories.pipe_addrmap.h ]
    fpp_mem_rspec:  # pipes
      args: [ name=memories.pipe, widereg ]
      memories.pipe_addrmap.h: [ decl ]
      memories.pipe_addrmap.cpp: [ defn, -Imemories.pipe_addrmap.h,
          -Imemories.ingress_parser.h, -Imemories.ingress_deparser.h,
          -Imemories.egress_parser.h, -Imemories.egress_deparser.h ]
    prsr_mem_rspec: # parser
      args: [ name=memories.ingress_parser ]
      memories.ingress_parser.h: [ decl ]
      memories.ingress_parser.cpp: [ defn, -Imemories.ingress_parser.h ]
    pprsr_mem_rspec: # pseudo-parser
      args: [ name=memories.egress_parser ]
      memories.egress_parser.h: [ decl ]
      memories.egress_parser.cpp: [ defn, -Imemories.egress_parser.h ]
    mdp_mem_rspec: # metadata packer
      args: [ name=memories.ingress_deparser ]
      memories.ingress_deparser.h: [ decl ]
      memories.ingress_deparser.cpp: [ defn, -Imemories.ingress_deparser.h ]
    dprsr_mem_rspec: # deparser
      args: [ name=memories.egress_deparser ]
      memories.egress_deparser.h: [ decl ]
      memories.egress_deparser.cpp: [ defn, -Imemories.egress_deparser.h ]
  regs:
    tfc_reg:
      args: [ name=regs.top ]
      regs.ftr_reg.h: [ decl ]
      regs.ftr_reg.cpp: [ defn, -Iregs.ftr_reg.h, -Iregs.pipe_addrmap.h ]
    fpp_rspec:  # pipe
      args: [ name=regs.pipe, widereg ]
      regs.pipe_addrmap.h: [ decl ]
      regs.pipe_addrmap.cpp: [ defn, -Iregs.pipe_addrmap.h, -Iregs.mau_addrmap.h,
          -Iregs.ingress_parser.h, -Iregs.ingress_deparser.h,
          -Iregs.egress_parser.h, -Iregs.egress_deparser.h ]
    ppu_rspec:  # mau
      args: [ name=regs.match_action_stage.%02x ]
      regs.mau_addrmap.h: [ decl ]
      regs.mau_addrmap.cpp: [ defn, -Iregs.mau_addrmap.h ]
      rewrite:
        #ppu_minput_rspec:
        #  minput_phe_pwr_erf: [ scan_chain, minput_byte_pwr, [9, 7], rf.minput_phe_pwr_scnsl ]
        #  minput_word_pwr_erf: [ scan_chain, minput_word_pwr, [2, 3], rf.minput_word_pwr_scnsl ]
        minput_em_bhash2_erf:
          minput_em_bhash2_scan: [ scan_chain, minput_em_bhash2, [5] ]
        #rf:
        #  minput_phe_pwr_scnsl: [ delete ]
        #  minput_word_pwr_scnsl: [ delete ]
        minput_dpreg_pwr_erf:
          minput_dpreg_pwr_scan: [ scan_chain, minput_dpreg_pwr, [55] ]
        minput_byte_pwr_erf:
          minput_byte_pwr_scan: [ scan_chain, minput_byte_pwr, [55] ]
        minput_word_pwr_erf:
          minput_word_pwr_scan: [ scan_chain, minput_word_pwr, [20] ]
        #ppu_em_hu_rspec:
        #  em_bytehash_extrf: [ scan_chain, em_bytehash, [40, 12], em_bytehash_scansel ]
        #  em_bytehash_scansel: [ delete ]
        #ppu_apx_rspec:
        #  apx_bytehash_extrf: [ scan_chain, apx_bytehash, [64, 8], apx_bytehash_scansel ]
        #  apx_bytehash_scansel: [ delete ]
    # no parser/deparser in csr yet?  Some stuff in fpp_rspec; is it enough?
    prsr_rspec: # parser
      args: [ name=regs.ingress_parser ]
      regs.ingress_parser.h: [ decl ]
      regs.ingress_parser.cpp: [ defn, -Iregs.ingress_parser.h ]
    pprsr_rspec: # pseudo-parser
      args: [ name=regs.egress_parser ]
      regs.egress_parser.h: [ decl ]
      regs.egress_parser.cpp: [ defn, -Iregs.egress_parser.h ]
    mdp_rspec: # metadata packer
      args: [ name=regs.ingress_deparser ]
      regs.ingress_deparser.h: [ decl ]
      regs.ingress_deparser.cpp: [ defn, -Iregs.ingress_deparser.h ]
    dprsr_rspec: # deparser
      args: [ name=regs.egress_deparser ]
      regs.egress_deparser.h: [ decl ]
      regs.egress_deparser.cpp: [ defn, -Iregs.egress_deparser.h ]

ignore:
  memories:
    # tfc_mem
    - tm_top_mem_rspec  # tm
    # fpp_mem_rspec
    # prsr_mem_rspec
    # pprsr_mem_rspec
    # dprsr_mem_rspec
    - ppu_pack_mem_rspec
    # mdp_mem_rspec
  regs:
    # tfc_reg
    - sys_addrmap
    - sbx_addrmap
    - tm_top_rspec
    - ethp_rspec
    # fpp / fpp_rspec
    - ifcu_rspec
    - pbus_station_regs_rspec  # prsr_pbus, mdp_pbus, pgr_pbus, pprsr_pbus, dprsr_pbus
    - prsr_pbus_regs_rspec  # prsr_rings
    - imrg_rspec
    - mdp_pbus_regs_rspec  # mdp_rings
    - pgr_pbus_regs_rspec  # pgr_rings
    - lfltr_rspec
    - mep_rspec
    - pprsr_pbus_regs_rspec  # pprsr_rings
    - emrg_rspec
    - dprsr_pbus_regs_rspec  # dprsr_rings
