global:
  - namespace=Flatrock
  - binary_offset
  - emit_binary
  - emit_fieldname
  - emit_json
  - enable_disable
  - widereg
  # - write_dma=galois_field_matrix
generate:
  memories:
    tfc_mem:
      args: [ name=memories.top ]
      memories.ftr_mem.h: [ decl ]
      memories.ftr_mem.cpp: [ defn, -Imemories.ftr_mem.h, -Imemories.pipe_addrmap.h ]
    fpp_mem_rspec:  # pipes
      args: [ name=memories.pipe, widereg ]
      memories.pipe_addrmap.h: [ decl ]
      memories.pipe_addrmap.cpp: [ defn, -Imemories.pipe_addrmap.h ]
  regs:
    tfc_reg:
      args: [ name=regs.top ]
      regs.ftr_reg.h: [ decl ]
      regs.ftr_reg.cpp: [ defn, -Iregs.ftr_reg.h, -Iregs.pipe_addrmap.h ]
    fpp_rspec:  # pipe
      args: [ name=regs.pipe, widereg ]
      regs.pipe_addrmap.h: [ decl ]
      regs.pipe_addrmap.cpp: [ defn, -Iregs.pipe_addrmap.h, -Iregs.mau_addrmap.h ]
    ppu_rspec:  # mau
      args: [ name=regs.match_action_stage.%02x ]
      regs.mau_addrmap.h: [ decl ]
      regs.mau_addrmap.cpp: [ defn, -Iregs.mau_addrmap.h ]
      rewrite:
        ppu_em_hu_rspec:
          em_bytehash_extrf: [ scan_chain, em_bytehash, [40, 12], em_bytehash_scansel ]
          em_bytehash_scansel: [ delete ]
        ppu_apx_rspec:
          apx_bytehash_extrf: [ scan_chain, apx_bytehash, [64, 8], apx_bytehash_scansel ]
          apx_bytehash_scansel: [ delete ]
    # no parser/deparser in csr yet?  Some stuff in fpp_rspec; is it enough?

ignore:
  memories:
    # tfc_mem
    - tm_top_mem_rspec  # tm
    # fpp_mem_rspec
    # prsr_mem_rspec
    # pprsr_mem_rspec
    - dprsr_mem_rspec
    - ppu_pack_mem_rspec
    - mdp_mem_rspec
  regs:
    # tfc_reg
    - dvsl_addrmap
    # fpp / fpp_rspec
