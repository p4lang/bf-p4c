

# Send full m2_greedy packet

expect 0 ffffffff44650000000000000800 450000640001000040007c977f0000017f000001
packet 0 ffffffffffff0000000000000800 450000640001000040007c977f0000017f000001 65656565656565656565656565656565656565656565656565656565656565656565656565656565 44444444444444444444444444444444444444444444444444444444444444444444444444444444

# Send m2_greedy packet missing bytes.

expect 0 ffffffff44650000000000000800 4500004c0001000040007caf7f000001
packet 0 ffffffffffff0000000000000800 4500004c0001000040007caf7f0000017f000001 65656565656565656565656565656565656565656565656565656565656565656565656565656565 44444444444444444444444444444444

# Send m2_greedy packet missing bytes.

expect 0 ffffffff33650000000000000800 450000480001000040007cb37f000001
packet 0 ffffffffffff0000000000000800 450000480001000040007cb37f0000017f000001 65656565656565656565656565656565656565656565656565656565656565656565656565656565 444444444444444444444444

# Send m2_greedy packet missing bytes.

expect 0 ffffffff22650000000000000800 450000440001000040007cb77f000001
packet 0 ffffffffffff0000000000000800 450000440001000040007cb77f0000017f000001 65656565656565656565656565656565656565656565656565656565656565656565656565656565 4444444444444444

# Send m2_greedy packet missing bytes.

expect 0 ffffffff11650000000000000800 450000400001000040007cbb7f000001
packet 0 ffffffffffff0000000000000800 450000400001000040007cbb7f0000017f000001 65656565656565656565656565656565656565656565656565656565656565656565656565656565 44444444

# Send m2_greedy packet missing bytes.

expect 0 ffffffff00650000000000000800 4500003c0001000040007cbf7f000001
packet 0 ffffffffffff0000000000000800 4500003c0001000040007cbf7f0000017f000001 65656565656565656565656565656565656565656565656565656565656565656565656565656565

# Send full m2 packet.

expect 0 ffffffff44640000000000000800 450000640001000040007c977f0000017f000001
packet 0 ffffffffffff0000000000000800 450000640001000040007c977f0000017f000001 6464646464646464646464646464646464646464646464646464646464646464646464646464646 444444444444444444444444444444444444444444444444444444444444444444444444444444444

# Send m2 packet with missing bytes (32 bytes instead of 40 bytes)
#
# Because m2 is equal to 32 bytes, the first 32 bytes were extracted and the match in table check_meta2
# reports that the 4 fields were present.  However, although this is not shown by this test, a
# PacketTooShort error was raised at the parser.

expect 0 ffffffff44640000000000000800 4500005c0001000040007c9f7f0000017f000001
packet 0 ffffffffffff0000000000000800 4500005c0001000040007c9f7f0000017f000001 6464646464646464646464646464646464646464646464646464646464646464646464646464646 44444444444444444444444444444444444444444444444444444444444444444

# Send m2 packet with missing bytes (less and 32 bytes)
# Table check_meta2 reports that all match field are set to 0.

expect 0 ffffffff00640000000000000800 450000540001000040007ca77f0000017f000001 444444444444444444444444444444444444444444444444
packet 0 ffffffffffff000000000000080 0450000540001000040007ca77f0000017f000001 6464646464646464646464646464646464646464646464646464646464646464646464646464646 4444444444444444444444444444444444444444444444444

